# **UC1 — Регистрация и заполнение анкеты**

**Цель:** Создать анкету для участия в поиске. **Предусловие:** Пользователь впервые запускает бота.

### Основной сценарий

1. Пользователь запускает бота и нажимает «Начать».
    
2. Бот последовательно запрашивает:
    
    - имя
        
    - пол
        
    - возраст
        
    - районы проживания
        
    - фото
        
    - «О себе»
        
    - срок пребывания в городе
        
3. Бот сохраняет анкету.
    
4. Бот предлагает перейти к поиску людей.
    

---

# **UC2 — Ранжированный просмотр анкет при малом количестве пользователей**

**Цель:** Найти подходящего человека. **Предусловия:** Анкета заполнена.

### Основной сценарий

1. Пользователь нажимает «Поиск людей».
    
2. Бот сортирует людей по приоритету:
    
    1. онлайн (активные за последние 5–10 минут)
        
    2. недавно онлайн (до 2 часов)
        
    3. остальные
        
3. У каждой анкеты есть кнопки:
    
    - «Скип»
        
    - «Назад»
        
    - «Следующая анкета»
        
    - «Позвать на встречу»
        
4. Листание можно делать в обе стороны.
    
5. При выборе «Позвать на встречу» → запуск UC3.
    

---

# **UC3 — Одно активное приглашение (мэтч)**

**Цель:** Отправить приглашение на встречу. **Ограничение:** Один активный мэтч.

### Основной сценарий

1. Пользователь нажимает «Позвать на встречу».
    
2. Бот проверяет, есть ли активный мэтч.
    
3. Если есть — сообщает: «Подожди ответа по текущему приглашению».
    
4. Если нет:
    
    1. Сообщает отправителю: «Приглашение отправлено! Ответ в течение 2–5 минут».
        
    2. Второму пользователю отправляет:
        
        - анкету инициатора
            
        - кнопки «Принять» / «Отклонить»
            
5. Если получатель не ответил 2–5 минут:
    
    - приглашение истекает
        
    - отправителю снова доступна кнопка «Позвать на встречу»
        

---

# **UC4 — Принятие или отклонение приглашения**

**Цель:** Завершить процесс мэтча.

### Основной сценарий (принятие)

1. Пользователь B получает приглашение.
    
2. Нажимает «Принять».
    
3. Бот:
    
    - фиксирует мэтч
        
    - отправляет точку встречи (локация + фото места)
        
    - запрашивает текущее фото
        
    - запускает таймер встречи (UC4.1)
        

### Альтернативы

- Если B нажимает «Отклонить» — A получает уведомление.
    
- Если B не отвечает — приглашение истекает.
    

---

# **UC4.1 — Таймер встречи + напоминания + начало встречи**

**Цель:** Управлять временем встречи. **Предусловие:** Оба приняли приглашение.

### Основной сценарий

1. После мэтча фиксируется время T0.
    
2. Запускается таймер на 60 минут.
    
3. Бот отправляет напоминания:
    
    - T0 + 15 мин → осталось 45 мин
        
    - T0 + 30 мин → осталось 30 мин
        
    - T0 + 45 мин → осталось 15 мин
        
    - T0 + 50 мин → осталось 10 мин
        
    - T0 + 55 мин → осталось 5 мин
        
4. В момент начала встречи (T0 + 60 мин) бот пишет:
    
    > «Встреча началась! Если вы ещё не встретились — вы опаздываете.»
    
5. Если кто-то нажимает «Мы встретились»:
    
    - таймер удаляется
        
    - напоминания отменяются
        
    - встреча помечается как состоявшаяся
        
6. После T0 + 75 минут (если подтверждения нет):
    
    - встреча истекает
        
    - обоим приходит сообщение
        
    - мэтч разблокируется
        

---

# **UC6 — Подтверждение встречи**

**Цель:** Завершить встречу вручную.

### Основной сценарий

1. У обоих есть кнопки:
    
    - «Мы встретились»
        
    - «Отменить встречу»
        
2. Один нажимает «Мы встретились».
    
3. Бот:
    
    - фиксирует успешную встречу
        
    - отменяет таймеры
        
    - уведомляет обоих
        

---

# **UC7 — Отмена встречи пользователем**

**Цель:** Позволить пользователю корректно отменить назначенную встречу. **Предусловие:** Взаимный мэтч, встреча назначена.

### Основной сценарий

1. Пользователь нажимает кнопку **«Отменить встречу»**.
    
2. Бот проверяет текущее время относительно старта встречи:
    

### **Вариант A — Отмена раньше чем за 30 минут до встречи**

- Бот отменяет встречу **без последствий**.
    
- У обоих удаляются таймеры.
    
- У обоих появляется уведомление:
    
    > «Встреча отменена. Можете начать поиск заново.»
    
- Возможность мэтчиться **снова доступна сразу**.
    

### **Вариант B — Отмена позже чем за 30 минут до встречи**

- Бот отменяет встречу.
    
- У обоих приходит уведомление:
    
    > «Встреча отменена. У инициатора ограничение на 5 часов.»
    
- У отменившего блокируются приглашения на **5 часов**.
    
- У второго пользователя ограничений нет.
    

---

# **UC8 — Обратная связь о пользователе или о боте**

**Цель:** Позволить оставлять отзывы.

### Основной сценарий

1. Пользователь нажимает кнопку **«Обратная связь»**.
    
2. Бот предлагает варианты:
    
    - «Пожаловаться на пользователя»
        
    - «Похвалить пользователя»
        
    - «Отзыв о боте»
        
3. Пользователь вводит текст.
    
4. Бот сохраняет отзыв в админ-панели / базе данных.
    
5. Бот благодарит пользователя.
    

---

# ACCEPTANCE CRITERIA (обновлено)

## **AC1 — Ранжирование пользователей**

Выполнено, если:

- пользователи сортируются по активности
    
- своя анкета не показывается
    
- при малом числе людей система корректно работает
    

## **AC2 — Ограничение: один активный мэтч**

- невозможно отправить второе приглашение
    
- после истечения/отмены можно снова приглашать
    

## **AC3 — Истечение приглашения через 2–5 минут**

- работает строго в пределах окна
    
- отправитель получает сообщение об истечении
    

## **AC4 — Принятие/отклонение**

- кнопки доступны
    
- при принятии отправляется точка встречи
    

## **AC4.2 — Таймер встречи (60 мин + 75 мин)**

- T0 фиксируется
    
- все события работают независимо от онлайна пользователя
    

## **AC4.3 — Напоминания**

- рассылаются ровно по расписанию
    
- не дублируются
    
- удаляются при подтверждении встречи
    

## **AC6 — Подтверждение встречи**

- одно нажатие завершает встречу
    
- таймеры отменяются
    

## **AC7 — Отмена встречи (НОВОЕ)**

### Условия выполненности:

- отмена ранее чем за 30 минут → без санкций
    
- отмена позднее чем за 30 минут → 5 часов блокировки мэтча
    
- второму пользователю ограничения не применяются
    

## **AC8 — Обратная связь**

Выполнено, если:

- кнопка отображается в меню
    
- бот принимает текст
    
- данные сохраняются в БД